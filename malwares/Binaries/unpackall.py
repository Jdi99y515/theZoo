#!/usr/bin/env python
# -*- coding: utf-8 -*-

import os
import glob
import zipfile

out_dir = 'out'

for mwr_dir in glob.glob('*'):
    password = None
    passfile = os.path.join(mwr_dir, mwr_dir + '.pass')
    if os.path.exists(passfile):
        password = open(os.path.join(mwr_dir, mwr_dir + '.pass'), 'rb').read().strip()
    out_path = os.path.join(out_dir, mwr_dir)
    if not os.path.exists(out_path):
        os.makedirs(out_path)

    for mwr in glob.glob(mwr_dir + '/*.zip'):
        try:
            infile = zipfile.ZipFile(mwr, 'r')
            infile.extractall(out_path, pwd=password)
        except Exception as e:
            print(mwr, e)
